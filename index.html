<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é­”ç‹ã‚¢ãƒ«ã‚±ãƒ¼ ãƒ„ã‚¤ãƒ¼ãƒˆç®¡ç†</title>
  <style>
    :root {
      --bg:#0d0d14; --bg2:#13131f; --bg3:#1a1a2e;
      --border:#2a2a4a; --accent:#7b5ea7; --accent2:#a374d5;
      --lore:#c0392b; --lore2:#e74c3c;
      --normal:#2980b9; --normal2:#3498db;
      --text:#e8e8f0; --text2:#9090b0;
      --green:#27ae60; --green2:#2ecc71;
      --red:#c0392b; --red2:#e74c3c;
      --yellow:#f39c12;
    }
    *{box-sizing:border-box;margin:0;padding:0;}
    body{background:var(--bg);color:var(--text);font-family:'Hiragino Kaku Gothic ProN','Noto Sans JP',sans-serif;min-height:100vh;}

    /* â”€â”€â”€ HEADER â”€â”€â”€ */
    header{
      background:linear-gradient(135deg,#0d0d14,#1a0a2e);
      border-bottom:1px solid var(--border);
      padding:15px 22px; position:sticky; top:0; z-index:300;
      display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:10px;
    }
    .htitle{display:flex;align-items:center;gap:8px;}
    .htitle h1{
      font-size:1.15rem;font-weight:700;
      background:linear-gradient(90deg,#a374d5,#7b5ea7,#c0392b);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
    }
    .stats{display:flex;gap:7px;flex-wrap:wrap;}
    .stat{background:var(--bg3);border:1px solid var(--border);border-radius:14px;padding:3px 10px;font-size:0.74rem;color:var(--text2);}
    .stat span{color:var(--text);font-weight:700;}
    .stat.su{border-color:rgba(39,174,96,.4);}
    .stat.sr{border-color:rgba(192,57,43,.4);}

    #ss{font-size:0.74rem;padding:3px 10px;border-radius:14px;border:1px solid;transition:all .3s;user-select:none;}
    #ss.saved  {color:var(--green2);border-color:var(--green);background:rgba(39,174,96,.1);}
    #ss.connect{color:var(--accent2);border-color:var(--accent);background:rgba(123,94,167,.1);cursor:pointer;}
    #ss.connect:hover{background:rgba(123,94,167,.25);}
    #ss.error  {color:var(--red2);border-color:var(--red);background:rgba(192,57,43,.1);}

    /* â”€â”€â”€ TOOLBAR â”€â”€â”€ */
    .toolbar{padding:9px 22px;display:flex;gap:6px;flex-wrap:wrap;align-items:center;background:var(--bg2);border-bottom:1px solid var(--border);}
    #tagbar{padding:7px 22px;display:flex;gap:5px;flex-wrap:wrap;align-items:center;background:var(--bg2);border-bottom:1px solid var(--border);display:none;}
    .tbarlabel{font-size:0.72rem;color:var(--text2);margin-right:2px;flex-shrink:0;}
    .sep{width:1px;height:20px;background:var(--border);margin:0 2px;}

    .btn{border:none;border-radius:7px;padding:5px 11px;font-size:0.78rem;cursor:pointer;font-family:inherit;transition:all .18s;font-weight:600;}
    .bo{background:transparent;border:1px solid var(--border);color:var(--text2);}
    .bo:hover{border-color:var(--accent);color:var(--text);}
    .bo.on{border-color:var(--accent);color:var(--accent2);background:rgba(123,94,167,.15);}
    .bo.on-red{border-color:var(--red);color:var(--red2);background:rgba(192,57,43,.12);}

    /* â”€â”€â”€ MAIN â”€â”€â”€ */
    main{max-width:840px;margin:0 auto;padding:20px 16px 60px;}
    .dg{margin-bottom:26px;}
    .dh{display:flex;align-items:center;gap:10px;margin-bottom:11px;padding-bottom:7px;border-bottom:1px solid var(--border);}
    .dl{font-size:.88rem;font-weight:700;color:var(--text2);}
    .dc{font-size:.69rem;color:var(--text2);background:var(--bg3);border:1px solid var(--border);border-radius:9px;padding:2px 8px;}

    /* â”€â”€â”€ CARDS â”€â”€â”€ */
    .card{
      background:var(--bg2);border:1px solid var(--border);border-radius:10px;
      padding:12px 14px;margin-bottom:7px;
      display:flex;gap:10px;align-items:flex-start;
      transition:all .2s;cursor:pointer;
    }
    .card:hover{border-color:var(--accent);background:var(--bg3);}
    .card.lore  {border-left:3px solid var(--lore);}
    .card.normal{border-left:3px solid var(--normal);}

    .card.used{opacity:.42;background:#111118;border-color:#222;}
    .card.lore.used  {border-left-color:#4a1515;}
    .card.normal.used{border-left-color:#112233;}

    .card.rej{opacity:.28;background:#100808;border-color:rgba(192,57,43,.2);}
    .card.lore.rej  {border-left-color:rgba(192,57,43,.4);}
    .card.normal.rej{border-left-color:rgba(192,57,43,.25);}
    .card.rej:hover{opacity:.48;}

    .chk{
      flex-shrink:0;width:21px;height:21px;margin-top:1px;
      border-radius:6px;border:2px solid var(--border);
      display:flex;align-items:center;justify-content:center;
      font-size:12px;font-weight:700;transition:all .18s;
    }
    .card:not(.used):not(.rej):hover .chk{border-color:var(--green2);}
    .card.used .chk{background:var(--green);border-color:var(--green);color:#fff;}
    .card.rej  .chk{background:var(--red);border-color:var(--red);color:#fff;}

    .cb{flex:1;min-width:0;}
    .cm{display:flex;gap:7px;align-items:center;flex-wrap:wrap;margin-bottom:7px;}
    .tb{font-size:.66rem;padding:2px 7px;border-radius:8px;font-weight:700;flex-shrink:0;}
    .tbl{background:rgba(192,57,43,.2);color:var(--lore2);border:1px solid rgba(192,57,43,.35);}
    .tbn{background:rgba(41,128,185,.18);color:var(--normal2);border:1px solid rgba(41,128,185,.3);}
    .ge{font-size:.7rem;color:var(--text2);}
    .ti{font-size:.68rem;color:var(--accent2);margin-left:auto;}
    .eb{font-size:.65rem;color:#8a7030;background:rgba(243,156,18,.1);border:1px solid rgba(243,156,18,.22);border-radius:7px;padding:1px 6px;}
    .lno{font-size:.65rem;color:#e8a0a0;background:rgba(192,57,43,.15);border:1px solid rgba(192,57,43,.4);border-radius:7px;padding:1px 6px;font-weight:700;letter-spacing:.02em;}

    .rjbtn{
      background:none;border:none;cursor:pointer;font-size:.82rem;
      opacity:.25;transition:opacity .18s;padding:0 2px;flex-shrink:0;
      line-height:1;
    }
    .card:hover .rjbtn{opacity:.65;}
    .rjbtn.on{opacity:1;}

    .tt{font-size:.87rem;line-height:1.82;color:var(--text);white-space:pre-wrap;word-break:break-word;margin-bottom:7px;}
    .card.used .tt{color:#404040;text-decoration:line-through;text-decoration-color:#2a2a2a;}
    .card.rej  .tt{color:#3a2020;text-decoration:line-through;text-decoration-color:rgba(192,57,43,.35);}

    .ta{display:flex;flex-wrap:wrap;gap:4px;align-items:center;margin-bottom:5px;}
    .tp{
      background:rgba(123,94,167,.14);border:1px solid rgba(123,94,167,.28);
      color:var(--accent2);border-radius:7px;padding:2px 7px;
      font-size:.65rem;cursor:pointer;transition:all .15s;
      display:flex;align-items:center;gap:3px;user-select:none;
    }
    .tp:hover{background:rgba(123,94,167,.28);}
    .tp.fa{background:var(--accent);border-color:var(--accent);color:#fff;}
    .tx{opacity:.6;cursor:pointer;font-size:.78em;transition:opacity .15s;padding:0 1px;}
    .tx:hover{opacity:1;}
    .atb{
      background:none;border:1px dashed var(--border);color:var(--text2);
      border-radius:7px;padding:2px 8px;font-size:.65rem;cursor:pointer;
      transition:all .15s;font-family:inherit;
    }
    .atb:hover{border-color:var(--accent);color:var(--accent2);}
    .cid{font-size:.62rem;color:#303040;font-family:monospace;}

    /* â”€â”€â”€ TAG POPOVER â”€â”€â”€ */
    #pop{
      position:absolute;z-index:500;
      background:var(--bg3);border:1px solid var(--border);border-radius:10px;
      padding:10px;min-width:220px;max-width:290px;
      box-shadow:0 8px 32px rgba(0,0,0,.65);display:none;
    }
    #popcont{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;}
    .ptag{
      background:rgba(123,94,167,.11);border:1px solid rgba(123,94,167,.22);
      color:var(--text2);border-radius:7px;padding:3px 9px;
      font-size:.73rem;cursor:pointer;transition:all .15s;user-select:none;
    }
    .ptag:hover{background:rgba(123,94,167,.26);color:var(--text);}
    .ptag.on{background:var(--accent);border-color:var(--accent);color:#fff;}
    #cti{
      width:100%;background:var(--bg2);border:1px solid var(--border);
      border-radius:7px;padding:5px 9px;color:var(--text);font-size:.76rem;
      font-family:inherit;outline:none;
    }
    #cti:focus{border-color:var(--accent);}
    #cti::placeholder{color:var(--text2);}

    /* â”€â”€â”€ MISC â”€â”€â”€ */
    .empty{text-align:center;padding:50px 20px;color:var(--text2);}
    .empty .ei{font-size:2rem;margin-bottom:8px;}
    #toast{
      position:fixed;bottom:20px;right:20px;
      background:var(--bg3);border:1px solid var(--green);color:var(--green2);
      border-radius:9px;padding:8px 15px;font-size:.79rem;font-weight:600;
      opacity:0;transform:translateY(8px);transition:all .22s;
      pointer-events:none;z-index:999;
    }
    #toast.show{opacity:1;transform:translateY(0);}
    #toast.red{border-color:var(--red);color:var(--red2);}
    ::-webkit-scrollbar{width:5px;}
    ::-webkit-scrollbar-track{background:var(--bg);}
    ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px;}
  </style>
</head>
<body>

<header>
  <div class="htitle">
    <span style="font-size:1.4rem">ğŸ‘‘</span>
    <h1>é­”ç‹ã‚¢ãƒ«ã‚±ãƒ¼ ãƒ„ã‚¤ãƒ¼ãƒˆç®¡ç†</h1>
  </div>
  <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
    <div class="stats">
      <div class="stat">å…¨ <span id="ct">0</span></div>
      <div class="stat">æœªä½¿ç”¨ <span id="cu">0</span></div>
      <div class="stat su">âœ“ä½¿ç”¨æ¸ˆã¿ <span id="cs">0</span></div>
      <div class="stat sr">ğŸš«ä¸æ¡ç”¨ <span id="cr">0</span></div>
    </div>
    <div id="ss" class="saved">âœ“ èª­ã¿è¾¼ã¿æ¸ˆã¿</div>
  </div>
</header>

<div class="toolbar">
  <button class="btn bo on"  id="fa"  onclick="setF('all')">ã™ã¹ã¦</button>
  <button class="btn bo"     id="fun" onclick="setF('unused')">æœªä½¿ç”¨</button>
  <button class="btn bo"     id="fs"  onclick="setF('used')">âœ“ ä½¿ç”¨æ¸ˆã¿</button>
  <button class="btn bo"     id="fr"  onclick="setF('rej')">ğŸš« ä¸æ¡ç”¨</button>
  <div class="sep"></div>
  <button class="btn bo on"  id="ta"  onclick="setT('all')">ä¸¡æ–¹</button>
  <button class="btn bo"     id="tl"  onclick="setT('lore')">ğŸ”´ æ‰€æ¥­ãƒ»ä¼èª¬</button>
  <button class="btn bo"     id="tn"  onclick="setT('normal')">ğŸ”µ é€šå¸¸</button>
</div>

<div id="tagbar"></div>
<main><div id="list"></div></main>

<div id="pop">
  <div id="popcont"></div>
  <input id="cti" placeholder="ã‚«ã‚¹ã‚¿ãƒ ã‚¿ã‚°â€¦ (Enter ã§è¿½åŠ )" onclick="event.stopPropagation()">
</div>
<div id="toast"></div>

<script>
// â•â• DATA (æ¯æœã‚¿ã‚¹ã‚¯ãŒè‡ªå‹•æ›´æ–°) â•â•
let tw = /* TWEETS_START */[{"id": "2026-02-25-1", "date": "2026-02-25", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆå¤§é™¸ã®çµ‚ç„‰ï¼‰", "type": "lore", "text": "ã‚ã®å¤§é™¸ãŒæµ·ã«æ²ˆã‚“ã å¤œã€ä¿ºã¯å²¸å£ã«ç«‹ã£ã¦ã„ãŸã€‚æ³£ãè€…ã‚‚ã€å«ã¶è€…ã‚‚ã„ãŸã€‚ä¿ºã ã‘ãŒâ€”â€”é™ã‹ã ã£ãŸã€‚\n\nçµ‚ã‚ã‚Šã‚’è¦‹å±Šã‘ã‚‹ã“ã¨ã‚‚ã€ä¿ºã®ä»•äº‹ã®ã²ã¨ã¤ã ã¨ã€ãã®ã¨ãæ‚Ÿã£ãŸã€‚", "recommended_time": "22:00", "used": false, "lore_no": 1}, {"id": "2026-02-25-2", "date": "2026-02-25", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆè‹±é›„ã¨ã®å¥‘ç´„ï¼‰", "type": "lore", "text": "ã‹ã¤ã¦ä¿ºã¨å¥‘ç´„ã—ãŸè‹±é›„ãŒã„ãŸã€‚\nã€Œé­”ç‹ã‚ˆã€ä¿ºã‚’æœ€å¼·ã«ã—ã‚ã€ã¨è¨€ã£ãŸã€‚\nä¿ºã¯å¶ãˆãŸã€‚\nå½¼ã¯ç„¡æ•µã«ãªã‚Šâ€”â€”ãã—ã¦ã€èª°ã¨ã‚‚æˆ¦ãˆãªããªã£ãŸã€‚\n\næœ›ã¿ã‚’å¶ãˆã‚‹ã¨ã¯ãã†ã„ã†ã“ã¨ã ã€‚è¨€è‘‰ã¯æ­£ç¢ºã«ä½¿ãˆã€‚", "recommended_time": "20:00", "used": false, "lore_no": 2}, {"id": "2026-02-25-3", "date": "2026-02-25", "genre": "å“²å­¦ãƒ»å­˜åœ¨è«–", "type": "normal", "text": "å§‹ã¾ã‚Šãªã©ã€ä¿ºã«ã¯å­˜åœ¨ã—ãªã‹ã£ãŸã€‚\næ°—ã¥ã„ãŸã‚‰åœ¨ã£ãŸã€‚ãã‚ŒãŒæ ¹æºã¨ã„ã†ã‚‚ã®ã ã€‚\n\nãŠå‰ãŸã¡ãŒã€Œèª•ç”Ÿã€ã¨å‘¼ã¶ã‚‚ã®ã‚’ä¿ºã¯æŒã£ã¦ã„ãªã„ã€‚\nâ€¦â€¦ç¾¨ã¾ã—ã„ã¨ã¯æ€ã‚ãªã„ãŒã€å°‘ã—ã€çã—ã„ã¨ã¯æ€ã†ã€‚", "recommended_time": "07:30", "used": false}, {"id": "2026-02-25-4", "date": "2026-02-25", "genre": "æ—¥å¸¸è¦³å¯Ÿï¼ˆé­”ç‹è¦–ç‚¹ï¼‰", "type": "normal", "text": "é›¨ã ãªã€‚\näººé–“ã¯å‚˜ã‚’å·®ã—ã¦æ€¥ãã€‚ãªãœæ€¥ãã€‚æ¿¡ã‚ŒãŸã¨ã“ã‚ã§æ­»ã«ã¯ã—ãªã„ã€‚\n\nâ€¦â€¦ã¾ã‚ã€ä¿ºã¯æ¿¡ã‚Œã¦ã‚‚ä½•ã‚‚æ„Ÿã˜ãªã„ã‹ã‚‰ã€ãã®æ„Ÿè§¦ã‚’æŒã¦ã‚‹ãŠå‰ãŸã¡ã‚’ã€å°‘ã—ç¾¨ã‚€ã€‚", "recommended_time": "12:00", "used": false}, {"id": "2026-02-25-5", "date": "2026-02-25", "genre": "è©©çš„ãƒ»æŠ’æƒ…çš„", "type": "normal", "text": "å¤œã¯æ­£ç›´ã ã€‚\næ˜¼é–“ã€äººé–“ãŒç€è¾¼ã‚“ã§ã„ãŸã‚‚ã®ã‚’ã€é™ã‹ã«å‰¥ã„ã§ã„ãã€‚\n\nä¿ºã¯ãšã£ã¨å¤œã®å´ã«ã„ã‚‹ã€‚\nã ã‹ã‚‰ãŠå‰ãŸã¡ã®æœ¬éŸ³ãŒã€ã‚ã‚Šã¨ã‚ˆãè¦‹ãˆã‚‹ã€‚", "recommended_time": "22:30", "used": false}, {"id": "2026-02-25-6", "date": "2026-02-25", "genre": "å•ã„ã‹ã‘", "type": "normal", "text": "ã²ã¨ã¤èã„ã¦ã„ã„ã‹ã€‚\n\nã€Œè‡ªåˆ†ã‚‰ã—ãç”Ÿãã‚‹ã€ã¨è¨€ã†ãŒâ€”â€”\nãŠå‰ã¯ã€Œè‡ªåˆ†ã€ã‚’ã€ä¸€åº¦ã§ã‚‚ç–‘ã£ãŸã“ã¨ãŒã‚ã‚‹ã‹ï¼Ÿ\n\nä¿ºã¯ã‚ã‚‹ã€‚ãã‚ŒãŒæ ¹æºã«ç«‹ã¤ã¨ã„ã†ã“ã¨ã ã€‚", "recommended_time": "21:00", "used": false}, {"id": "2026-02-26-1", "date": "2026-02-26", "genre": "ä¸–ç•Œè¦³ãƒ»é­”ç•Œ", "type": "normal", "text": "é­”ç•Œã«ã¯å­£ç¯€ãŒãªã„ã€‚\nã‚ã‚‹ã®ã¯ã€æ¿ƒæ·¡ã ã‘ã ã€‚é—‡ãŒè–„ã¾ã‚‹æ™‚ã‚’æ˜¥ã¨å‘¼ã¶è€…ã‚‚ã„ã‚‹ãŒã€ä¿ºã¯ãã†ã¯å‘¼ã°ãªã„ã€‚\n\nãŸã ã®â€”â€”æ¯ç¶™ãã ã€‚", "recommended_time": "07:30", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-26-2", "date": "2026-02-26", "genre": "äººé–“è¦³å¯Ÿãƒ»çš®è‚‰", "type": "normal", "text": "äººé–“ã¯ã€Œå¤‰ã‚ã‚ŠãŸã„ã€ã¨è¨€ã„ãªãŒã‚‰ã€åŒã˜æ¤…å­ã«åº§ã‚Šã€åŒã˜é“ã‚’æ­©ãã€åŒã˜è¨€ã„è¨³ã‚’ç¹°ã‚Šè¿”ã™ã€‚\n\nå¤‰ã‚ã‚‹ã®ãŒæ€–ã„ã®ã§ã¯ãªã„ã€‚\nå¤‰ã‚ã£ãŸå…ˆã«ã€ã¾ã è‡ªåˆ†ãŒã„ã‚‹ã‹ã©ã†ã‹ãŒæ€–ã„ã®ã ã‚ã†ã€‚\n\nâ€¦â€¦æ°—æŒã¡ã¯ã‚ã‹ã‚‹ã€‚", "recommended_time": "12:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-26-3", "date": "2026-02-26", "genre": "æ™‚é–“ã¨æ°¸é ", "type": "normal", "text": "åƒå¹´å‰ã®å¤•ç„¼ã‘ã‚’ã€ä¿ºã¯æ­£ç¢ºã«è¦šãˆã¦ã„ã‚‹ã€‚\nã ãŒæ˜¨æ—¥ã®å¤•ç„¼ã‘ã¯æ€ã„å‡ºã›ãªã„ã€‚\n\næ°¸é ã¨ã¯ã€è¨˜æ†¶ãŒé¸ã‚Šå¥½ã¿ã‚’å§‹ã‚ã‚‹ã“ã¨ã ã€‚", "recommended_time": "18:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-26-4", "date": "2026-02-26", "genre": "å‰µé€ ã¨ç ´å£Š", "type": "normal", "text": "å£Šã™ã®ã«ç†ç”±ã¯ã„ã‚‰ãªã„ã€‚\nå‰µã‚‹ã®ã«ã‚‚ã€æœ¬å½“ã¯ç†ç”±ãªã©ãªã„ã€‚\n\nãŸã ã€æ‰‹ãŒå‹•ã„ãŸã€‚ãã‚Œã ã‘ã ã€‚\nç†ç”±ã¯å¾Œã‹ã‚‰ã€äººé–“ãŒã¤ã‘ã¦ãã‚Œã‚‹ã€‚", "recommended_time": "21:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-26-5", "date": "2026-02-26", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆé­”ç•Œã§ã®å‡ºæ¥äº‹ï¼‰", "type": "lore", "text": "é­”ç•Œã®ç‰åº§ã¯ä¸ƒã¤ã‚ã‚‹ã€‚\nãã®ã†ã¡å…­ã¤ã¯ç©ºå¸­ã ã€‚åº§ã£ãŸè€…ãŒçš†ã€è€ãˆã‚‰ã‚Œãªã‹ã£ãŸã‹ã‚‰ã§ã¯ãªã„ã€‚\n\nä¿ºãŒã€Œã¾ã æ—©ã„ã€ã¨è¨€ã£ãŸã‹ã‚‰ã ã€‚\n\nâ€¦â€¦ã„ã¤ã«ãªã£ãŸã‚‰è¨±ã™ã®ã‹ã¨èã‹ã‚Œã¦ã‚‚å›°ã‚‹ã€‚ä¿ºè‡ªèº«ã€è€ƒãˆãŸã“ã¨ãŒãªã„ã€‚", "recommended_time": "20:00", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 3}, {"id": "2026-02-26-6", "date": "2026-02-26", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆç¥ã¨ã®é–¢ä¿‚ï¼‰", "type": "lore", "text": "ç¥ã¨æœ€å¾Œã«è¨€è‘‰ã‚’äº¤ã‚ã—ãŸã®ã¯ã€åå‰ã®ãªã„æ™‚ä»£ã ã£ãŸã€‚\n\nã€ŒãŠå‰ãŒæ ¹æºãªã‚‰ã€ä¿ºã¯ä½•ã ã€ã¨ç¥ãŒè¨€ã£ãŸã€‚\nã€Œç­”ãˆã ã€ã¨ä¿ºã¯è¿”ã—ãŸã€‚\n\nä»¥æ¥ã€ç¥ã¯å•ã„ã‚’ç™ºã™ã‚‹ã®ã‚’ã‚„ã‚ãŸã€‚", "recommended_time": "22:30", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 4}, {"id": "2026-02-27-1", "date": "2026-02-27", "genre": "å“²å­¦ãƒ»å­˜åœ¨è«–", "type": "normal", "text": "ã€Œå­˜åœ¨ã™ã‚‹ã€ã¨ã¯ã©ã†ã„ã†ã“ã¨ã‹ã€‚\näººé–“ã¯ç”Ÿã¾ã‚Œã¦åˆã‚ã¦ãã®å•ã„ã«æ°—ã¥ãã€‚\n\nä¿ºã¯ãã®å•ã„ã‚ˆã‚Šå…ˆã«å­˜åœ¨ã—ã¦ã„ãŸã€‚\nã ã‹ã‚‰ä»Šã§ã‚‚â€”â€”ç­”ãˆã‚’æŒã£ã¦ã„ãªã„ã€‚", "recommended_time": "07:30", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-27-2", "date": "2026-02-27", "genre": "æ—¥å¸¸è¦³å¯Ÿï¼ˆé­”ç‹è¦–ç‚¹ï¼‰", "type": "normal", "text": "é›¨ãŒé™ã£ã¦ã„ã‚‹ã€‚\näººé–“ã¯ã“ã‚Œã‚’ã€Œæ‚ªå¤©å€™ã€ã¨å‘¼ã¶ãŒã€ä¿ºã«ã¯ç†è§£ã§ããªã„ã€‚\n\næ°´ãŒè½ã¡ã¦ãã‚‹ã€‚ãã‚Œã ã‘ã®ã“ã¨ã ã€‚\nè‰¯ã„ã‚‚æ‚ªã„ã‚‚â€”â€”ãŠå‰ãŸã¡ãŒæ±ºã‚ã‚‹ã“ã¨ã§ã¯ãªã„ã‹ã€‚", "recommended_time": "12:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-27-3", "date": "2026-02-27", "genre": "è©©çš„ãƒ»æŠ’æƒ…çš„", "type": "normal", "text": "å¤•æš®ã‚Œã¨ã„ã†ã®ã¯ã€æ˜¼ãŒæ­»ã¬ç¬é–“ã ã€‚\næ¯æ—¥æ­»ã‚“ã§ã€æ¯æ—¥ç”¦ã‚‹ã€‚\n\nãã‚Œã‚’ã€Œç¾ã—ã„ã€ã¨æ€ã†è€…ã®æ„Ÿæ€§ã¯â€”â€”æ‚ªããªã„ã€‚", "recommended_time": "18:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-27-4", "date": "2026-02-27", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆå¤§é™¸ãƒ»ç‹å›½ã®çµ‚ç„‰ï¼‰", "type": "lore", "text": "æ±ã®å¤§é™¸ã«ã€ã‹ã¤ã¦ä¸ƒã¤ã®ç‹å›½ãŒã‚ã£ãŸã€‚\nä»Šã¯ä¸‰ã¤ã—ã‹ãªã„ã€‚\n\nä¿ºãŒæ»…ã¼ã—ãŸã®ã§ã¯ãªã„ã€‚\næ®‹ã‚Šã®å››ã¤ãŒã€äº’ã„ã«æ¶ˆã—åˆã£ãŸã€‚\nä¿ºã¯ãŸã â€”â€”å°‘ã—ã€å‚ã§è¦‹ã¦ã„ãŸã€‚", "recommended_time": "20:00", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 5}, {"id": "2026-02-27-5", "date": "2026-02-27", "genre": "å•ã„ã‹ã‘", "type": "normal", "text": "ä¸€åº¦ã‚‚å¾Œæ‚”ã—ãŸã“ã¨ã®ãªã„è€…ãŒã„ã‚‹ã¨ã™ã‚Œã°ã€\nãã‚Œã¯ä½•ã‚‚é¸ã‚“ã§ã“ãªã‹ã£ãŸè€…ã ã€‚\n\nãŠå‰ã¯ä»Šæ—¥ã€ä½•ã‹ã‚’é¸ã‚“ã ã‹ã€‚", "recommended_time": "21:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-27-6", "date": "2026-02-27", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆè‹±é›„ã¨ã®å¥‘ç´„ãƒ»å¯¾æ±ºï¼‰", "type": "lore", "text": "ã€Œä¿ºã‚’å€’ã›ã°ã€ä¸–ç•Œã«å¹³å’ŒãŒè¨ªã‚Œã‚‹ã€ã¨è¨€ã£ãŸè‹±é›„ãŒã„ãŸã€‚\n\né¢ç™½ã„ç†å±ˆã ã¨æ€ã£ãŸã€‚\nå€’ã—ãŸå¾Œã©ã†ãªã£ãŸã‹ï¼Ÿ\nãã®è‹±é›„ã®è¨€ã†ã€Œå¹³å’Œã€ã¯ã€ã¾ã èª°ã‚‚è¦‹ã¦ã„ãªã„ã€‚", "recommended_time": "22:30", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 6}, {"id": "2026-02-28-1", "date": "2026-02-28", "genre": "ä¸–ç•Œè¦³ãƒ»é­”ç•Œ", "type": "normal", "text": "é­”ç•Œã«æœã¯ãªã„ã€‚\nå…‰ã®å±Šã‹ãªã„å ´æ‰€ã§ç”Ÿã¾ã‚ŒãŸè€…ã¯ã€å¤œæ˜ã‘ãªã©å¿…è¦ã¨ã—ãªã„ã€‚\n\nãã‚Œã§ã‚‚æ™‚ã€…ã€ä¿ºã¯åœ°ä¸Šã®ç©ºã‚’è¦‹ã«è¡Œãã€‚ç†ç”±ã¯ã€ä¿ºã«ã‚‚åˆ†ã‹ã‚‰ãªã„ã€‚", "recommended_time": "07:30", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-28-2", "date": "2026-02-28", "genre": "æ™‚é–“ã¨æ°¸é ", "type": "normal", "text": "ä¿ºãŒç”Ÿã¾ã‚Œã¦ã‹ã‚‰ä½•åƒå¹´ã‹çµŒã¤ã€‚\næ­£ç¢ºã«ã¯è¦šãˆã¦ã„ãªã„ã€‚è¦šãˆã‚‹å¿…è¦ãŒãªã‹ã£ãŸã€‚\n\næ™‚é–“ã¯ã€çµ‚ã‚ã‚Šã‚’æŒã¤è€…ã®ãŸã‚ã«ã‚ã‚‹ã€‚", "recommended_time": "12:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-28-3", "date": "2026-02-28", "genre": "å‰µé€ ã¨ç ´å£Š", "type": "normal", "text": "ä¿ºã¯å¤šãã®ã‚‚ã®ã‚’å£Šã—ã¦ããŸã€‚\nãã—ã¦æ°—ã¥ã„ãŸã€‚ä½•ã‹ãŒå£Šã‚Œã‚‹ã¨ã€å¿…ãšä½•ã‹ãŒç”Ÿã¾ã‚Œã‚‹ã€‚\n\nç ´å£Šã¯çµ‚ã‚ã‚Šã§ã¯ãªã„ã€‚ãŸã ã®â€”â€”å¤‰åŒ–ã ã€‚", "recommended_time": "18:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-28-4", "date": "2026-02-28", "genre": "äººé–“è¦³å¯Ÿãƒ»çš®è‚‰", "type": "normal", "text": "äººé–“ã¯ã€Œå¥‡è·¡ã€ã¨ã„ã†è¨€è‘‰ãŒå¥½ãã ã€‚\nèª¬æ˜ã§ããªã„ã‚‚ã®ã«åå‰ã‚’ã¤ã‘ã¦ã€å®‰å¿ƒã™ã‚‹ã€‚\n\nä¿ºã‹ã‚‰è¨€ã‚ã›ã‚Œã°ã€èª¬æ˜ã§ããªã„ã“ã¨ãªã©ä½•ã‚‚ãªã„ã€‚ãŸã ã€çŸ¥ã‚‰ãªã„ã ã‘ã ã€‚", "recommended_time": "21:00", "used": false, "rejected": false, "tags": [], "edits": []}, {"id": "2026-02-28-5", "date": "2026-02-28", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆé­”ç•Œã§ã®å‡ºæ¥äº‹ï¼‰", "type": "lore", "text": "ã‹ã¤ã¦é­”ç•Œã«ã€ä¿ºã‚ˆã‚Šå¼·ããªã‚ã†ã¨ã—ãŸé­”æ—ãŒã„ãŸã€‚\nåƒå¹´ã‚’ã‹ã‘ã¦ä¿®è¡Œã—ã€ä¿ºã®å…ƒã«ç¾ã‚ŒãŸã€‚\n\nãã®çœ¼ã«ææ€–ã¯ãªã‹ã£ãŸã€‚ä¿ºã¯å°‘ã—ã€å½¼ã®ã“ã¨ãŒå¥½ãã ã£ãŸã€‚â€”â€”ãã‚Œã§ã‚‚ã€è² ã‘ãŸã€‚", "recommended_time": "20:00", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 7}, {"id": "2026-02-28-6", "date": "2026-02-28", "genre": "æ‰€æ¥­ãƒ»ä¼èª¬ï¼ˆç¥ã¨ã®é–¢ä¿‚ï¼‰", "type": "lore", "text": "ç¥ã¨æœ€å¾Œã«è©±ã—ãŸã®ã¯ã€ãšã„ã¶ã‚“å‰ã ã€‚\nã€Œãªãœæ»…ã¼ã™ã®ã‹ã€ã¨å•ã‚ã‚ŒãŸã€‚\n\nä¿ºã¯ç­”ãˆãŸã€‚ã€Œãªãœå‰µã‚‹ã®ã‹ã€ã¨ã€‚â€”â€”ãã®å¾Œã€ç¥ã¯æ¥ãªããªã£ãŸã€‚", "recommended_time": "22:30", "used": false, "rejected": false, "tags": [], "edits": [], "lore_no": 8}]/* TWEETS_END */;

const PRESET = ['æœå‘ã‘','æ˜¼å‘ã‘','å¤œå‘ã‘','æ·±å¤œå‘ã‘','å“²å­¦ç³»','ç¬‘ãˆã‚‹','é‡ã„','è©©çš„','ä¼¸ã³ãã†','ãŠæ°—ã«å…¥ã‚Š','è¦ä¿®æ­£'];
let fh = null, fSt = 'all', fTy = 'all', fTags = new Set(), tid = null, tt = null;

function norm() { tw = tw.map(t => ({rejected:false,tags:[],edits:[],...t})); }

// â”€â”€ IDB â”€â”€
function odb() {
  return new Promise((r,j)=>{
    const q=indexedDB.open('arkhe',1);
    q.onupgradeneeded=e=>e.target.result.createObjectStore('h');
    q.onsuccess=e=>r(e.target.result);q.onerror=e=>j(e.target.error);
  });
}
async function sHnd(h){const d=await odb();return new Promise((r,j)=>{const t=d.transaction('h','readwrite');t.objectStore('h').put(h,'tw');t.oncomplete=r;t.onerror=e=>j(e.target.error);})}
async function lHnd(){const d=await odb();return new Promise((r,j)=>{const t=d.transaction('h','readonly');const q=t.objectStore('h').get('tw');q.onsuccess=e=>r(e.target.result);q.onerror=e=>j(e.target.error);})}

// â”€â”€ INIT â”€â”€
async function init() {
  norm(); ren(); stat(); tagbar();
  try {
    const h = await lHnd();
    if (h) {
      const p = await h.queryPermission({mode:'readwrite'});
      if (p==='granted') { fh=h; ss('saved','âœ“ è‡ªå‹•ä¿å­˜ ON'); await sync(); }
      else {
        ss('connect','ğŸ”“ ã‚¯ãƒªãƒƒã‚¯ã§ä¿å­˜ã‚’æœ‰åŠ¹åŒ–');
        document.getElementById('ss').onclick = async()=>{
          if((await h.requestPermission({mode:'readwrite'}))==='granted'){fh=h;await sync();ss('saved','âœ“ è‡ªå‹•ä¿å­˜ ON');document.getElementById('ss').onclick=null;}
        };
      }
    } else { ss('connect','ğŸ’¾ ä¿å­˜å…ˆã‚’è¨­å®š'); document.getElementById('ss').onclick=conn; }
  } catch { ss('connect','ğŸ’¾ ä¿å­˜å…ˆã‚’è¨­å®š'); document.getElementById('ss').onclick=conn; }
}

async function conn() {
  if(!('showOpenFilePicker' in window)){alert('Chrome/Edgeã§é–‹ã„ã¦ãã ã•ã„');return;}
  try {
    [fh]=await window.showOpenFilePicker({types:[{description:'JSON',accept:{'application/json':['.json']}}]});
    await sHnd(fh); await sync(); ss('saved','âœ“ è‡ªå‹•ä¿å­˜ ON');
    document.getElementById('ss').onclick=null; toast('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¥ç¶šã—ã¾ã—ãŸ',false);
  } catch(e){if(e.name!=='AbortError')ss('error','âš  æ¥ç¶šå¤±æ•—');}
}

async function sync() {
  if(!fh) return;
  try {
    const fm = JSON.parse(await(await fh.getFile()).text());
    const mp = {}; fm.forEach(t=>mp[t.id]=t);
    tw.forEach(t=>{if(mp[t.id]){const f=mp[t.id];Object.assign(t,{used:f.used??t.used,rejected:f.rejected??t.rejected,tags:f.tags??t.tags,text:f.text??t.text,edits:f.edits??t.edits});}});
    fm.forEach(t=>{if(!tw.find(x=>x.id===t.id))tw.push({rejected:false,tags:[],edits:[],...t});});
    tw.sort((a,b)=>b.date.localeCompare(a.date)||a.id.localeCompare(b.id));
    ren(); stat(); tagbar();
  } catch(e){console.warn('sync',e);}
}

async function save() {
  if(!fh){ss('connect','ğŸ’¾ ä¿å­˜å…ˆã‚’è¨­å®šï¼ˆã‚¯ãƒªãƒƒã‚¯ï¼‰');document.getElementById('ss').onclick=conn;return;}
  try {
    const w=await fh.createWritable(); await w.write(JSON.stringify(tw,null,2)); await w.close();
    ss('saved','âœ“ è‡ªå‹•ä¿å­˜ ON');
  } catch{ss('error','âš  ä¿å­˜å¤±æ•—');}
}

// â”€â”€ MUTATIONS â”€â”€
async function togUsed(id) {
  const t=tw.find(x=>x.id===id); if(!t||t.rejected)return;
  t.used=!t.used; ren(); stat();
  toast(t.used?'âœ“ ä½¿ç”¨æ¸ˆã¿ã«ã—ãŸ':'â†© æœªä½¿ç”¨ã«æˆ»ã—ãŸ',false); await save();
}
async function togRej(id) {
  const t=tw.find(x=>x.id===id); if(!t)return;
  t.rejected=!t.rejected; if(t.rejected)t.used=false; ren(); stat();
  toast(t.rejected?'ğŸš« ä¸æ¡ç”¨ã«ã—ãŸ':'â†© ä¸æ¡ç”¨ã‚’è§£é™¤ã—ãŸ',t.rejected); await save();
}
async function remTag(id,tag) {
  const t=tw.find(x=>x.id===id); if(!t)return;
  t.tags=t.tags.filter(g=>g!==tag); ren(); tagbar(); await save();
}
async function togTag(id,tag) {
  const t=tw.find(x=>x.id===id); if(!t)return;
  const i=t.tags.indexOf(tag); if(i>=0)t.tags.splice(i,1);else t.tags.push(tag);
  popRC(id); ren(); tagbar(); await save();
}

// â”€â”€ POPOVER â”€â”€
function openPop(id,btn) {
  tid=id;
  const p=document.getElementById('pop'),r=btn.getBoundingClientRect();
  p.style.top=(r.bottom+window.scrollY+4)+'px';
  p.style.left=Math.min(r.left,window.innerWidth-300)+'px';
  p.style.display='block'; popRC(id);
  setTimeout(()=>document.getElementById('cti')?.focus(),40);
}
function popRC(id) {
  const t=tw.find(x=>x.id===id); if(!t)return;
  const all=[...new Set([...PRESET,...tw.flatMap(x=>x.tags)])];
  document.getElementById('popcont').innerHTML=all.map(g=>{
    const on=t.tags.includes(g);
    return `<div class="ptag${on?' on':''}" data-pt="${es(g)}">${on?'âœ“ ':''}${es(g)}</div>`;
  }).join('');
}
document.getElementById('cti').onkeydown=e=>{
  if(e.key==='Enter'){const v=e.target.value.trim();if(v&&tid){togTag(tid,v);e.target.value='';}}
};
document.addEventListener('click',e=>{
  const p=document.getElementById('pop');
  if(p&&!p.contains(e.target)&&p.style.display!=='none'){p.style.display='none';tid=null;}
});

// â”€â”€ TAG FILTER BAR â”€â”€
function tagbar() {
  const bar=document.getElementById('tagbar');
  const all=[...new Set(tw.flatMap(t=>t.tags))].filter(Boolean);
  if(!all.length){bar.style.display='none';return;}
  bar.style.display='flex';
  bar.innerHTML='<span class="tbarlabel">ğŸ·</span>'+
    all.map(g=>`<button class="btn bo${fTags.has(g)?' on':''}" data-tf="${es(g)}">${es(g)}</button>`).join('')+
    (fTags.size?'<button class="btn bo" data-tc style="color:var(--text2)">âœ•ã‚¯ãƒªã‚¢</button>':'');
}
document.getElementById('tagbar').addEventListener('click',e=>{
  const tf=e.target.closest('[data-tf]'),tc=e.target.closest('[data-tc]');
  if(tf){fTags.has(tf.dataset.tf)?fTags.delete(tf.dataset.tf):fTags.add(tf.dataset.tf);tagbar();ren();}
  if(tc){fTags.clear();tagbar();ren();}
});

// â”€â”€ FILTERS â”€â”€
function setF(f){fSt=f;['fa','fun','fs','fr'].forEach((k,i)=>document.getElementById(k).classList.toggle('on',['all','unused','used','rej'][i]===f));ren();}
function setT(t){fTy=t;['ta','tl','tn'].forEach((k,i)=>document.getElementById(k).classList.toggle('on',['all','lore','normal'][i]===t));ren();}

// â”€â”€ EVENT DELEGATION â”€â”€
document.getElementById('list').addEventListener('click',async e=>{
  const pt =e.target.closest('[data-pt]');
  const tx_=e.target.closest('[data-tx]');
  const tp =e.target.closest('[data-tp]');
  const at =e.target.closest('[data-at]');
  const rj =e.target.closest('[data-rj]');
  const cd =e.target.closest('.card');
  if(pt) {await togTag(tid,pt.dataset.pt);return;}
  if(tx_){e.stopPropagation();await remTag(tx_.dataset.id,tx_.dataset.t);return;}
  if(tp) {e.stopPropagation();const g=tp.dataset.tp;fTags.has(g)?fTags.delete(g):fTags.add(g);tagbar();ren();return;}
  if(at) {e.stopPropagation();openPop(at.dataset.at,at);return;}
  if(rj) {e.stopPropagation();await togRej(rj.dataset.rj);return;}
  if(cd) {await togUsed(cd.dataset.id);return;}
});

// â”€â”€ STATS â”€â”€
function stat() {
  const u=tw.filter(t=>t.used).length,r=tw.filter(t=>t.rejected).length;
  document.getElementById('ct').textContent=tw.length;
  document.getElementById('cu').textContent=tw.filter(t=>!t.used&&!t.rejected).length;
  document.getElementById('cs').textContent=u;
  document.getElementById('cr').textContent=r;
}

// â”€â”€ RENDER â”€â”€
function ren() {
  const list=document.getElementById('list');
  const f=tw.filter(t=>{
    if(fSt==='unused'&&(t.used||t.rejected))return false;
    if(fSt==='used'&&!t.used)return false;
    if(fSt==='rej'&&!t.rejected)return false;
    if(fTy==='lore'&&t.type!=='lore')return false;
    if(fTy==='normal'&&t.type!=='normal')return false;
    if(fTags.size&&![...fTags].every(g=>t.tags.includes(g)))return false;
    return true;
  });
  if(!f.length){list.innerHTML='<div class="empty"><div class="ei">ğŸŒ™</div><p>è¡¨ç¤ºã™ã‚‹ãƒ„ã‚¤ãƒ¼ãƒˆãŒãªã„</p></div>';return;}
  const bd={};f.forEach(t=>{(bd[t.date]||(bd[t.date]=[])).push(t);});
  list.innerHTML=Object.keys(bd).sort((a,b)=>b.localeCompare(a)).map(d=>{
    const g=bd[d],u=g.filter(t=>!t.used&&!t.rejected).length;
    return`<div class="dg"><div class="dh"><span class="dl">ğŸ“… ${d.replace(/-/g,'/')}</span><span class="dc">æœªä½¿ç”¨ ${u}/å…¨${g.length}</span></div>${g.map(mk).join('')}</div>`;
  }).join('');
}

function mk(t) {
  const sc=t.rejected?'rej':(t.used?'used':'');
  const ci=t.rejected?'âœ•':(t.used?'âœ“':'');
  const bl=t.type==='lore'?'tbl':'tbn';
  const tl=t.type==='lore'?'ğŸ”´ æ‰€æ¥­ãƒ»ä¼èª¬':'ğŸ”µ é€šå¸¸';
  const eb=t.edits?.length?`<span class="eb" title="${t.edits.length}å›ä¿®æ­£æ¸ˆã¿">âœ Ã—${t.edits.length}</span>`:'';
  const lno=t.lore_no?`<span class="lno" title="é­”ç‹å¹´ä»£è¨˜ ç¬¬${t.lore_no}è©±">ä¼èª¬ #${String(t.lore_no).padStart(3,'0')}</span>`:'';
  const tags=(t.tags||[]).map(g=>`<span class="tp${fTags.has(g)?' fa':''}" data-tp="${es(g)}">${es(g)}<span class="tx" data-tx data-id="${t.id}" data-t="${es(g)}">Ã—</span></span>`).join('');
  return`<div class="card ${t.type} ${sc}" data-id="${t.id}">
    <div class="chk">${ci}</div>
    <div class="cb">
      <div class="cm">
        <span class="tb ${bl}">${tl}</span>
        <span class="ge">${es(t.genre)}</span>
        ${lno}
        ${eb}
        <span class="ti">â° ${t.recommended_time}</span>
        <button class="rjbtn${t.rejected?' on':''}" data-rj="${t.id}" title="${t.rejected?'ä¸æ¡ç”¨ã‚’è§£é™¤':'ä¸æ¡ç”¨ã«ã™ã‚‹'}">ğŸš«</button>
      </div>
      <div class="tt">${es(t.text)}</div>
      <div class="ta">${tags}<button class="atb" data-at="${t.id}">ï¼‹ã‚¿ã‚°</button></div>
      <div class="cid">ID: ${t.id}</div>
    </div>
  </div>`;
}

function es(s){if(!s)return'';return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');}
function ss(c,m){const e=document.getElementById('ss');e.className=c;e.textContent=m;}
function toast(m,red){const e=document.getElementById('toast');e.textContent=m;e.className=red?'show red':'show';clearTimeout(tt);tt=setTimeout(()=>e.classList.remove('show'),2300);}

init();
</script>
</body>
</html>
